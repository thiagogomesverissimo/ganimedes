<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
   xmlns:p="http://primefaces.org/ui" xmlns:b="http://bootsfaces.net/ui" xmlns:fn="http://java.sun.com/jsp/jstl/functions">

<h:head>
   <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
   <meta http-equiv="refresh" content="#{session.maxInactiveInterval};url=index.xhtml?reason=expired" />


</h:head>

<h:body>

   <ui:composition template="../template.xhtml">

      <ui:define name="content">

         <f:view>
            <f:loadBundle basename="messages" var="msgs" />

            <b:container fluid="false">
               <b:row>
                  <b:column span="12">

                     <h:form id="main">

                        <h2>Cadastro de usuário</h2>

                        <p:message for="main" />
                     </h:form>

                     <h:form id="cadastro" binding="#{mbAnunciante.frmCadastro}">

                        <p:panel>

                           <h:panelGrid columns="2">
                              <h:outputText value="Nome completo: *" />
                              <p:inputText id="nome" value="#{mbAnunciante.usuario.nompes}" size="30" required="true"
                                 requiredMessage="Nome completo é um campo obrigatório." />

                              <h:outputText value="Email: *" rendered="#{!mbAnunciante.edicao}" />
                              <p:inputText id="codlog" value="#{mbAnunciante.usuario.codlog}" size="30" rendered="#{!mbAnunciante.edicao}" required="true"
                                 requiredMessage="Email é um campo obrigatório." validatorMessage="Email inválido.">
                                 <f:validateRegex pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
                              </p:inputText>

                              <h:outputText value="Confirmar email: *" rendered="#{!mbAnunciante.edicao}" />
                              <p:inputText id="codlog2" value="#{mbAnunciante.codlogConfirmacao}" size="30" rendered="#{!mbAnunciante.edicao}" required="true"
                                 requiredMessage="Confirmar email é um campo obrigatório." />

                              <h:outputText value="Email atual:" rendered="#{mbAnunciante.edicao}" />
                              <h:outputText value="#{mbAnunciante.usuario.codlog}" rendered="#{mbAnunciante.edicao}" />

                              <h:outputText value="Novo email:" rendered="#{mbAnunciante.edicao}" />
                              <p:inputText id="codloge" value="#{mbAnunciante.codlog}" size="30" rendered="#{mbAnunciante.edicao}"
                                 validatorMessage="Email inválido.">
                                 <f:validateRegex pattern="^$|^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
                              </p:inputText>

                              <h:outputText value="Confirmar novo email: *" rendered="#{mbAnunciante.edicao}" />
                              <p:inputText id="codloge2" value="#{mbAnunciante.codlogConfirmacao}" size="30" rendered="#{mbAnunciante.edicao}" />

                              <h:outputText value="Senha:" rendered="#{!mbAnunciante.edicao}" />
                              <p:password id="pwd1" value="#{mbAnunciante.senhaNova}" size="30" match="pwd2" rendered="#{!mbAnunciante.edicao}" redisplay="true"
                                 required="true" requiredMessage="Senha é um campo obrigatório." validatorMessage="Senhas não conferem." />

                              <h:outputText value="Confirmar senha: *" rendered="#{!mbAnunciante.edicao}" />
                              <p:password id="pwd2" value="#{mbAnunciante.senhaNova}" size="30" rendered="#{!mbAnunciante.edicao}" redisplay="true"
                                 required="true" requiredMessage="Confirmar senha é um campo obrigatório." />

                              <h:outputText value=" Nova senha: *" rendered="#{mbAnunciante.edicao}" />
                              <p:password id="pwde1" value="#{mbAnunciante.senhaNova}" size="30" match="pwde2" rendered="#{mbAnunciante.edicao}"
                                 redisplay="true" validatorMessage="Senhas não conferem" />

                              <h:outputText value="Confirmar nova senha:" rendered="#{mbAnunciante.edicao}" />
                              <p:password id="pwde2" value="#{mbAnunciante.senhaNova}" size="30" redisplay="true" rendered="#{mbAnunciante.edicao}" />

                              <p:separator />
                              <p:separator />

                              <h:outputText value="CPF: *" />
                              <p:inputMask id="cpf" value="#{mbAnunciante.usuario.cpf}" size="30" mask="?999.999.999-99" required="true"
                                 requiredMessage="CPF é um campo obrigatório.">
                                 <f:validator validatorId="validator.CPFValidator" />
                              </p:inputMask>



                              <h:outputText value="Telefone com DDD: *" />
                              <p:inputMask id="telefone" value="#{mbAnunciante.usuario.telefone}" size="30" mask="?(99) 999999999"
                                 validatorMessage="Telefone inválido. Digite apenas números.">
                                 <ui:remove>
                                    <f:validateRegex pattern="^$|^[(][0-9]{2}[)] [0-9]{4,5}-[0-9]{4}$" />
                                 </ui:remove>
                                 <f:validateRegex pattern="^$|^[(][0-9]{2}[)] [0-9]{8,9}$" />
                              </p:inputMask>



                              <p:separator rendered="#{mbAnunciante.edicao}" />
                              <p:separator rendered="#{mbAnunciante.edicao}" />

                              <h:outputText value="Senha atual: *" rendered="#{mbAnunciante.edicao}" />
                              <p:password value="#{mbAnunciante.senhaAtual}" size="30" rendered="#{mbAnunciante.edicao}" required="true"
                                 requiredMessage="Senha atual é um campo obrigatório." />
                           </h:panelGrid>


                           <p:message for="codlog" />
                           <p:message for="codloge2" />
                           <p:message for="cpf" />
                           <p:message for="telefone" />
                           <p:message for="pwde1" />
                           <p:message for="pwde2" />
                           <p:message for="pwd1" />
                           <p:message for="pwd2" />

                           <p:commandButton value="Confirmar Cadastro" action="#{mbAnunciante.criarAnunciante()}" ajax="false" />

                           <p:commandButton value="Cancelar" action="#{PageTransition.chamaLogin()}" ajax="false" immediate="true" />


                        </p:panel>

                     </h:form>


                     <h:form id="confirmacao" binding="#{mbAnunciante.frmConfirmacao}" rendered="false">
                        <p:panel>
                           <p>
                              <b>Conta Criada com Sucesso!</b>
                           </p>

                           <p>
                           <br />
                              Prezado(a)                      
                              <h:outputText value="#{mbAnunciante.usuario.nompes}:" />
                              <br />Sua conta de acesso ao Sistema Ganimedes foi criada com sucesso. <br />Para acessar o sistema é necessário ativar a sua
                              conta. <br /> <br />As instruções para ativação serão enviadas para o seu e-mail. Por favor, aguarde alguns minutos. <br /> <br />Em
                              caso de dúvida ou caso tenha algum problema, entre em contato conosco. <br />
                              <br />
                              <em><h:outputText value="#{mbAnunciante.ou}" /></em> <br />
                              <h:outputText value="#{mbAnunciante.instituicao}" />
                              <br />
                              <h:outputLink value="#{mbAnunciante.website}">
                                 <h:outputText value="#{mbAnunciante.website}" />
                              </h:outputLink>
                              <br /> <a href="mailto:#{mbAnunciante.email}"> <h:outputText value="#{mbAnunciante.email}" />
                              </a> <br /> <a href="tel:#{mbAnunciante.fone}"> <h:outputText value="#{mbAnunciante.fone}" />
                              </a> <br />
                           </p>
                           <p>
                              <br />
                              <p:commandButton action="#{PageTransition.chamaLoginEmpresa()}" value="Acesso para empresas" ajax="false" />

                           </p>
                        </p:panel>
                     </h:form>

                  </b:column>
               </b:row>
            </b:container>

         </f:view>
      </ui:define>
   </ui:composition>

</h:body>
</html>
